<!doctype html>
<html>
  <head>
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
  </head>

  <body>
    <div id="sideload-msg" style="padding: 10px; background-color: #f0f0f0; text-align: center">
      This add-in is loaded.
    </div>

    <div id="app-body" style="display: none">
      <p>
        This add-in lets you create Meet video conferences and track participant engagement during the call, ensuring
        more productive and interactive meetings.
      </p>

      <button id="helloButton">Sign in</button>
    </div>

    <!-- The following image URL tracks diagnostic data for this sample add-in. Please remove the image tag if you reuse this sample in your own code project. -->
    <img src="https://pnptelemetry.azurewebsites.net/pnp-officeaddins/samples/outlook-add-in-hello-world-run" />

    <script>
      Office.onReady((info) => {
        if (info.host === Office.HostType.Outlook) {
          // Hide sideload message and show app body
          const sideloadMsg = document.getElementById("sideload-msg");
          const appBody = document.getElementById("app-body");

          if (sideloadMsg) {
            sideloadMsg.style.display = "none";
          }
          if (appBody) {
            appBody.style.display = "flex";
          }

          document.getElementById("helloButton").onclick = sayHello;
        }
      });

      function generateRandomNumber() {
        // Generate a random 6-digit number
        const randomNumber = Math.floor(100000 + Math.random() * 900000);
        return randomNumber;
      }

      function sayHello() {
        console.log("Buttone pressed");
      }

      /**
       * Writes 'Hello world!' to a new message body.
       */
      // function sayHello() {
      //   const bodyContent = `
      //     <div style="font-family:Arial, sans-serif; padding: 10px; font-size: 14px;">
      //       <img src="https://cinteraction.nswebdevelopment.com/web/addin/assets/cinteraction_logo.png" alt="Cinteraction" title="Cinteraction" />
      //       </br></br>
      //       <p>
      //         Join the meeting:
      //         <a href="https://cinteraction.nswebdevelopment.com/web/home/meeting/${12345}" target="_blank" style="color: #46139A; text-decoration: none;">
      //           https://cinteraction.nswebdevelopment.com/web/home/meeting/${12345}
      //         </a>
      //       </p>
      //       </br>
      //       <hr>
      //       <p style="font-size: 12px; color: #888;">
      //         This meeting invite was created using the Outlook Add-in.
      //       </p>
      //     </div>
      //   `;
      //   // Set the dynamically generated content with the meeting link into the email body
      //   Office.context.mailbox.item.body.setAsync(
      //     bodyContent,
      //     {
      //       coercionType: "html", // Specify HTML format
      //     },
      //     function (asyncResult) {
      //       if (asyncResult.status == Office.AsyncResultStatus.Failed) {
      //         // console.error(asyncResult.error.message);
      //       }
      //     }
      //   );
      // }
    </script>
  </body>
</html>
